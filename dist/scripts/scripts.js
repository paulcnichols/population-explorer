var scApp;!function(){"use strict";scApp=angular.module("ScaligentApp",["ui.router","ui.select2"]),scApp.config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/table"),a.state("table",{url:"/table",templateUrl:"/views/table.html",controller:"scTableController"}).state("graph",{url:"/graph",templateUrl:"/views/graph.html",controller:"scGraphController"})}]),scApp.run(["$rootScope","$state","$stateParams","$location","$http",function(a,b,c,d,e){a.$state=b,a.$stateParams=c,a.cols=[],a.rows=[],a.loading=!0,e.get("/world-pop.csv").then(function(b){var c=b.data.split("\n");a.cols=c.shift().split(","),c.pop(),a.rows=_.map(c,function(b,c){for(var d=b.split(","),e={},f=0;f<a.cols.length;++f)e[a.cols[f]]=f>=2?parseFloat(d[f])||0:d[f].trim();for(var g={},h=[],i=[],j=1960;2010>j;++j){var k=10*Math.floor(j/10),l=(void 0===e[j]?1:e[j])/1e6;void 0===g[k]&&(g[k]=0),g[k]+=l,h.push(l),i.push(Math.log(1+l))}var m=_.map(_.sortBy(_.keys(g)),function(a){return Math.round(g[a])});a.loading=!1;var n=parseFloat(100*((h[h.length-1]-h[0])/h[0])/h.length);return(1/0===n||isNaN(n))&&(n=0),{id:c,cName:e["Country Name"],cCode:e["Country Code"],namedData:e,decadeSeries:m,yearSeries:h,yearSeriesLog:i,growthRate:n}})}),a.sortAsc=!0,a.sortValName=!1,a.sortValCurrent=!1,a.sortValGrowth=!1,a.sortByName=function(){a.sortValName=!0,a.sortValCurrent=!1,a.sortValGrowth=!1,a.sortAsc=!a.sortAsc,a.rows=_.sortBy(a.rows,function(a){return a.cName}),a.sortAsc||(a.rows=a.rows.reverse())},a.sortByCurrent=function(){a.sortValName=!1,a.sortValCurrent=!0,a.sortValGrowth=!1,a.sortAsc=!a.sortAsc,a.rows=_.sortBy(a.rows,function(a){return a.yearSeries[a.yearSeries.length-1]}),a.sortAsc||(a.rows=a.rows.reverse())},a.sortByGrowth=function(){a.sortValName=!1,a.sortValCurrent=!1,a.sortValGrowth=!0,a.sortAsc=!a.sortAsc,a.rows=_.sortBy(a.rows,function(a){return a.growthRate}),a.sortAsc||(a.rows=a.rows.reverse())}}]),String.prototype.trim=function(){return String(this).replace(/^[\s"']+|[\s"']+$/g,"")}}(),function(){"use strict";scApp.controller("scTableController",["$scope",function(){}]),scApp.controller("scGraphController",["$scope","$rootScope","$filter",function(a,b,c){a.selectedAll=!1,a.filter="",a.type="line",a.init=function(){b.rows=_.sortBy(b.rows,function(a){return("HIC"===a.cCode||"LIC"===a.cCode||"MIC"===a.cCode||"UMC"===a.cCode||"LMC"===a.cCode)&&(a.selected=!0),a.cName}),a.update()},a.updateAll=function(){var d=!0;_.each(c("countryFilter")(b.rows,a.filter),function(a){a.selected||(d=!1)}),a.selectedAll=d},a.update=function(){a.updateAll();var c=_.filter(b.rows,function(a){return a.selected});if($("#chart").empty(),0!==c.length)if("line"===a.type){if(c.length>10)return $("#chart").append("<div id='sc-line-error'>10 countries maximum selected for line chart!</div>"),$("#sc-line-error").css({"text-align":"center","padding-top":"150px"}),void 0;$("#chart").highcharts({chart:{type:"area"},title:{text:"Population Growth by Country"},xAxis:{categories:_.map(_.range(1960,2010),function(a){return a}),labels:{formatter:function(){return 0===this.value%10?this.value:""}}},yAxis:{title:{text:"Population (Millions)"}},tooltip:{shared:!0,valueSuffix:" Million"},plotOptions:{area:{stacking:"normal",lineColor:"#666666",lineWidth:1,marker:{lineWidth:1,lineColor:"#666666"}}},series:_.map(c,function(a){return{name:a.cName,data:a.yearSeries}}),credits:{enabled:!1}})}else $("#chart").highcharts({chart:{type:"scatter",zoomType:"xy"},title:{text:"Population Size vs Growth by Country"},xAxis:{title:{enabled:!0,text:"Size (Millions)"},startOnTick:!0,endOnTick:!0,showLastLabel:!0},yAxis:{title:{text:"Growth Rate %"}},legend:{enabled:!1},plotOptions:{scatter:{tooltip:{headerFormat:"<b></b>",pointFormat:"<b>{point.name}</b><br/>Size: {point.x} Million<br/>Growth: {point.y}%<br/>"}}},series:[{name:"Population Size vs Growth",data:_.map(c,function(a){return{name:a.cName,x:a.yearSeries[a.yearSeries.length-1],y:a.growthRate}})}],credits:{enabled:!1}})},a.toggle=function(){_.each(c("countryFilter")(b.rows,a.filter),function(b){b.selected=a.selectedAll}),a.update()}}])}(),function(){"use strict";scApp.directive("scSparkline",[function(){return{scope:{data:"="},link:function(a,b){jQuery(b).sparkline(a.data,{type:"bar",width:"100px",height:"30px",barColor:"#3498DB",negBarColor:"#3498DB",barWidth:2,disableTooltips:!0})}}}])}(),function(){"use strict";scApp.filter("last",function(){return function(a){return a[a.length-1]}}),scApp.filter("range",["$rootScope",function(a){return function(b){return _.range(0,Math.ceil(b.length/a.pageSize))}}]),scApp.filter("countryFilter",function(){return function(a,b){return _.filter(a,function(a){return void 0===b||0===b.length?!0:a.cName.toLowerCase().indexOf(b.toLowerCase())>=0})}})}();